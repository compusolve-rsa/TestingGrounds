<p align="center">
  Данный текст доступен на нескольких языках.
</p>
<p align="center">
  <span><a href="https://github.com/pvlunegov/TestingGrounds/blob/master/README.md">English</a></span> |
  <a href="https://github.com/pvlunegov/TestingGrounds/blob/master/README.RU.md">Русский</a>
</p>

# ТестоваяАрена
Игра, шутер от первого лица созданная на движке Unreal Engine 4 с использованием C++ и Блупринтов.

Данный проект сделан по занятиям курса ["Разработчик Unreal Engine - Раздел 5".](Https://github.com/UnrealCourse/05_TestingGrounds)

[Репозиторий исходного курса](https://github.com/UnrealCourse/05_TestingGrounds) был создан изначально на версии движка Unreal Engine 4.12 - 4.13.
Данный проект сделан на более новой версии движка 4.21

## Несколько скриншотов из последних коммитов (сборок данного проекта):

| Скриншоты | Скриншоты |
| --- | --- |
| `Стрелки преследуют и стреляют в игрока. Стрелки патрулируют маршрут. Когда они видят игрока (игрок рядом с ними) или слышат игрока (игрок прыгает или стреляет), они преследуют его, стреляя во время бега. Когда они приближаются к игроку, они останавливаются и стреляют. Стрелки стреляют очередью по 3 патрона. Очереди слышатся разными, так как между выстрелами разное количество миллисекунд.` ![guards chasing and firing at player](https://user-images.githubusercontent.com/28482025/51083450-4c793800-173c-11e9-8735-79fe88a0bc37.png) | `Guards may die (player shoots them) falling to the ground holding weapons in their hands` ![guards may die falling to the ground in arms](https://user-images.githubusercontent.com/28482025/51083697-f908e900-173f-11e9-92e5-60413846e116.png) |
| `Умирающий игрок падает на землю с оружием в руках. Меш (3д объект, представляющий игрока в движке) от третьего лица лежит на земле. Меш от первого лица висит над землей. До сих пор не был разработан способ перехода от представления от первого лица к представлению от третьего лица. Сами меши работают корректно со всей анимацией. Как вы заметили, стрелки имеют меши как от первого лица, так и от третьего лица. Более того, у игрока и стрелка один и тот же Блупринт.`![player dying falls to the ground with a weapon in hand](https://user-images.githubusercontent.com/28482025/51084132-da5a2080-1746-11e9-9a37-6e42fc44eae4.png) | `Меши (деревья, бочки, мешки и т.д.) появляются в произвольном месте в Тайле. Тайл - это прямоугольная область фиксированных размеров со стенами и полом в виде земли. Игра порождает бесконечное количество тайлов. Игрок может перемещаться по этим тайлам.` ![spawning meshes and debug spheres png](https://user-images.githubusercontent.com/28482025/51083466-aaa61b00-173c-11e9-884c-4bf12a8a891c.png) |
| `Зеленый прозрачный барьер, разделяющий тайлы. Игрок может перейти к следующему тайлу. При переходе к следующему тайлу игра, генерирует послеследующий тайл со случайно генерируемыми мешами так, чтобы их расположения не пересекались` ![green barrier dividing tiles](https://user-images.githubusercontent.com/28482025/51083723-4be2a080-1740-11e9-8eaa-1e6a349f1592.png) | `Красный барьер, разделяющий тайлы. Игрок не может пройти сквозь него до прошлого тайла. Игрок может двигаться только вперед к следующему тайлу, отделенному от предыдущего зеленым прозрачным барьером.` ![red barrier dividing tiles player can not move through it](https://user-images.githubusercontent.com/28482025/51083728-759bc780-1740-11e9-9152-021def0f9af3.png) |

## Комментарии к комитам (сборкам данного проекта):

### 1 Введение в тестовую арену
Это первый коммит, я делаю новый проект C ++ в Unreal Editor 4.21

### 2 GDD в Тестовой Арене
Добавлен FPS контент в хранилище
Использую Git LFS (Large File Support)

### 3 Дальнейшее развитие проекта
Удалили и изменили некоторые настройки редактора

### 5  Добавленые некоторые новые фишки в проект. 
Добавлены (наклонная рампа, винтовая лестница, 2 этаж) к главной карте.

### 6 Добавлен Nav Mesh Volume  и персонаж от третьего лица на карту основного уровня.
Добавлен Nav Mesh Volume (объемная область в которой генерируется специальный объект для автоматической навигации).
Добавлен персонаж от третьего лица на карту основного уровня.

### 7 Добавлен Behavior Tree и BlackBoard Data.
Behavior Tree - это деревья поведений для искусственного интеллекта.
BlackBoard Data - это специальные таблицы значений и переменных для работы с деревьями поведений.

### 9 Добавлены функции Blueprint для последовательного перемещения по множеству точек патрулирования, определенных на карте, каждому солдату взвода.
Теперь солдаты бесконечно бегают по карте, каждый перемещается из точки в точку, каждый со своим набором точек.

### TG 10. Проектная логика была перенесена в C ++.
C ++ классы и логика территориального патрулирования были созданы.
Теперь солдаты патрулируют территорию уровня карты, их логика контролируется C ++

### TG 11. Логика C ++ была перемещена из унаследованных классов в систему компонентов.
На данный момент у каждого солдата есть класс компонента, который отвечает за его перемещение.

### TG 12. Добавлен материал для 2 солдат.
Каждый солдат-охранник теперь имеет разные цвета.

### TG 13. Создание AI_sense для патрулирования солдат.
AI_sense - специальный объект, который содержит логику распознавания и реагирования окружающих объектов искусственным интеллектом.
Теперь солдаты видят друг друга и игрока. Они сообщают в консоли, записывают, кого они видят и какую реакцию они использовали (видение, слушание и т. Д.).

### TG 14. Солдат охранник слышит, как игрок прыгает и сообщает об этом на консоль и на экран.
Слушание сделано с использованием Блупринтов.

### TG 15. Добавлен бесплатный стартовый пакет анимации от Unreal MarketPlace.
Unreal MarketPlace - это сервис для покупки контента (пакетов для создания проектов).

### TG 16. Добавлена Блупринт анимация из стартового пакета для наших Солдат.
Теперь они двигаются с винтовками в руках.
К сожалению, мне пока не удалось вывести оружие в правильное положение в руках мешей. Кроме того, оружие не отображается во время игры (во время анимации). Я позже это исправлю в будующих коммитах (сборках проекта).

### TG 17. Заменен Блупринт класс Guards на простой класс из пакета анимации.
Теперь Блупринт классы Guards стали более простыми и универсальными.

### TG 18. Произведен Рефакторинг файлов проекта.
Теперь папки организованы гораздо лучше и приятнее. Удалил содержимое корзины.

### TG 19. Рефакторинг исходной структуры классов C ++.
Теперь у нас есть папка «Player», куда мы перенесли класс C ++ со всеми зависимостями (классами и файлами которые зависят от данного класса).

### TG 20. Дополнительный Рефакторинг исходной структуры классов C ++.
В папке «Source» теперь есть папки, которые отражают структуру проекта.

### TG 21. Добавлено Оружие в руки наших солдат.
Теперь они бегают, приседают и несут оружие в руках.
Добавлен разьем в скелет NPC, к которому прикреплен меш оружия. Также убраны ненужные файлы.

### TG 22. Добавлена анимационный Блупринт (BlenSpace) "Walking_Ironsight" (Идет прицелившись) для наших солдат.
Теперь они идут по маршруту, целясь из своего оружие вперед.

### TG 23. Добавлен переменная для регулирования наклона прицела. Это сделано для плавной анимации, когда солдат направлеет оружие вверх и вниз.
Это смещение рук и оружия в анимации представлено только в редакторе. В будущем я буду использовать его для анимации солдат.

### TG 24. Добавлено поведение прицеливания оружия наших солдат.
Теперь они движутся по маршруту своего патрулирования, нацеливаясь на начальную точку игрока, в которой он появился при старте игры.

### TG 24.1. Теперь стражи, целятся в игрока в реальном времени!
Когда игрок меняет свое местоположение, Стражи направляют свое оружие на игрока и идут по маршруту их патрулирования.
Для этого изменены Блупринты AI (Искусственный интеллект).

### TG 25. Теперь солдаты преследуют игрока, когда они видят его.
Когда у них нет игрока в их сегменте видимости (они видят впереди себя), они патрулируют маршрут.
Это простое поведение AI (Искусственный интеллект) сделано в виде простого Дерева поведений с 2 ветками.

### TG 26. Теперь Солдаты, преследуя Игрока и теряя из виду игрока, перемещаются в последнее известное место игрока.
Если они не видят игрока, они движутся по маршруту патрулирования.

### TG 27. Исправлена ошибка, когда 2 Стража преследовали друг друга и после этого ничего не делали.
Когда они подбегали к игроку, их деревья поведений останавливали дальнейшие действия. Это был баг.
Были и другие неправильности в поведении, которые были исправлены.
Теперь гвардейцы игнорируют друг друга, патрулируя маршрут и преследуя игрока.

### TG 28. Создан класс Gun (Оружие) C ++. Это Экземпляр оружия, созданный в начале игры в руках игрока.
В будущем я буду использовать функцию стрельбы класса Gun в руках игрока.

### TG 28.1. Теперь наш игрок может стрелять пулями из оружия в руках. Анимация выстрела, звук, физика снарядов также были отлажены.
Класс Gun (Оружие) имеет свой собственный класс C ++ с функциями. Класс FirstPersonCharacter (Игрок от первого лица) вызывает функцию Fire (Стрельба) из класса Gun.

### TG 29. Перемещены все большие файлы в статическую (Static) папку.
Это поможет быстрее выполнять коммиты с системой Git LFS.

### TG 30. Обновлен файл .gitattributes для отслеживания только статической (Static) подпапки и всего ее содержимого.
Теперь git LFS получает только файлы в папке Static. Все остальные файлы в других папках будут включаться в коммиты Git.
Напоминаю, что в будущем все большие файлы я буду класть в папку Static.

### TG 31. Некоторые ассеты (файлы движка) LFS перемещены в папку Dynamic из папки Static.
Эти ассеты будут часто меняться в будущем. LFS не будет отслеживать эти ассеты. Эти ассеты будут перемещаться в коммиты Git напрямую.

### TG 32. Исправлена Inverse Kinematics (Инверсная кинематика) нашего ассета игрока.
Теперь руки игрока держатся за оружие корректно во время анимации.

### TG 33. Исправлен баг с прицеливанием солдат.
Теперь они не наводят оружие при патрулировании и не воспринимают врага. Ранее они целились в друг друга. Когда они воспринимают врага (видят или слышат шум), они преследуют его, направляя на него оружие. Когда они потеряли восприятие, они движутся к последнему увиденному месту и через несколько секунд возвращаются к патрульной службе.

### TG 34. Теперь охранники используют анимацию стрельбы при погоне за игроком.
Добавлены blend poses (смешивание различных анимаций) в графике анимации. Сейчас, в Блупринте, персонаж может бегать, прицеливаться, стрелять, бегать, стрелять от бедра. Все эти действия могут происходить вместе или раздельно через установку флажков (переменных в коде). Причем анимация корректно отображает все состояния вместе и раздельно. И все это достигнуто благодаря blend poses (смешивание различных анимаций).

### TG 35. Добавлен урон здоровью стражей и анимации смерти.
Теперь игрок может стрелять в солдат и может нанести им урон до их смерти.
Также произведен рефакторинг функций анимации в Блупринтах.

### TG 36. Теперь у игрока и солдат есть один Блупринт с камерой от первого и третьего лица, анимация стрельбы и смерти.
Игрок может умереть и получить урон, так же, как и солдаты.

### TG 37. Процедурная генерация Уровней (карт для игры) во время игры в цикле.
Теперь в начале игры создается ландшафт из 10 тайлов (кусков карты).

### TG 38. Теперь при входе в следующий тайл, предыдущий тайл обрезается красным барьером.
Впереди следующий тайл отделен от текущего тайла зеленым барьером.

### TG 39. Теперь у нас есть сборщик мусора, который удаляет старые тайлы, к которым мы не можем перейти. Впереди, генерируются 2 новых тайла, которые мы можем увидеть и перейти к ним.
Таким образом, у нас есть игра с бесконечной с генерацией тайлов, сборщик мусора старых тайлов.

### TG 40. Слияние наших файлов TP (Third Person - от Третьего Лица) и FP (First Person - от Первого Лица) в структуре проекта. Исправлена ошибка стрельбы из оружия.
Теперь стрельба выпускает пулю в нормальном направлении, наносит правильный урон солдатам, также отображаются сопутствующие сообщения о событиях при попадания пули.

### TG 41. Сделал динамический объем НавМеш. Теперь гвардейцы движутся по своему патрульному маршруту.
НавМеш (Navigation Mesh) это специальный объект который динамически генерирует карту маршрутов прохождения для маршрутизации искусственного интеллекта по карте.
Раньше солдаты не могли двигаться, потому что наш статический НавМеш не может работать с динамическими тайлами.

### TG 42. Переделал AI Блупринты, с помощью метода, называемого SUDO кодированием.
Теперь их намного проще читать на высоком уровне абстракции.

### TG 43. Исключил * _BuildData.uasset из Git, восстанавливая оружие дочернего класса Actor (Персонаж).
Это сделано для физического архитектуры класса Gun (Оружие), а не для компонентной архитектуры.
Также переименовал некоторые ресурсы в [Руководство по стилю UE4] (https://github.com/CosmoMyzrailGorynych/ue4-style-guide-rus/blob/master/README.md)

### TG 44. Преобразование Блупринта Персонажа в C ++
Теперь у нас есть C ++ класс Персонаж с функцией fire (Стрельба), вызывающий функцию Fire класса Gun C ++

### TG 45. Переделка Архитектура вызова функции стрельбы.
Ранее функция стрельбы вызывалась из события анимации. Теперь мы запускаем функцию из метода в C ++ Персонажном классе.
Теперь наши солдаты могут быстро и очень быстро стрелять!

### TG 46. Наши солдаты теперь делают серию из 3 выстрелов. Между выстрелами случайное количество времени.

### TG 47. Присоединил Оружие к разьему скелета меша с помощью Блупринт класса C ++ "Manneguin" (Маннекен).
Теперь наши солдаты держат в руках оружие с должной анимацией при ходьбе, стрельбе и смерти!
Наш игрок держит оружие в руках, когда стреляет, умирает, лежит на земле от третьего лица.

### TG 48. Добавлены бесплатные ассеты из Unreal MarketPlace (сервис контента Unreal) для мешей земли, растений, камней, бочек, сумок и других промышленных предметов.
Также добавлены несколько мешей на основной уровень для целей тестирования.

### TG 49. Спаун (генерация) Блупринт мешей (3д объектов) в Тайле в случайных местах.
Теперь у нас есть генерация случайных мест в тайле!

### TG 50. Генерация трассировочных (отладочных) сфер для отладки и тестирования. 
Сейчас у нас геренируются специальные отладочные сферы. Эти сферы мы будем использовать позже для процедурной геренации более сложных объектов.

### TG 51. Исправлены ошибки, вызванные отсутствием некоторых ресурсов в сборке Блупринта Тайла.
Unreal Editor вылетает при запуске игры. Теперь все ок, баги исправлены, запуск игры работает корректно.
